---
import districts from '../../../src/assets/json/Apdistricts.json';

interface District {
  id: string;
  name: string;
  path: string;
  url: string;
  color?: string;
  labelPosition: {
    x: number;
    y: number;
  };
}
---
<style>
  .map-container {
    position: relative;
    width: 100%;
    max-width: 1000px;
    margin: 10vh auto;
    padding: 0 30px;
  }

  .andhra-pradesh-map {
    width: 100%;
    height: auto;
    transform: scale(1.3);
  }

  .district-tooltip {
    position: fixed;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 14px;
    pointer-events: none;
    z-index: 1000;
    transition: opacity 0.2s ease;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    display: none;
  }

  path:hover {
    fill: #ffa500 !important;
    cursor: pointer;
  }

  text {
    font-size: 14px;
    pointer-events: none;
  }
  .district-name{
    font-size:25px;
  }
</style>

<div class="map-container">
  <svg
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    viewBox="0 0 1200 900"
    class="andhra-pradesh-map"
  >
    <!-- Loop through each district -->
    {districts.map((district) => (
      <g>
        <path
          d={district.path}
          fill={district.color || '#ccc'}
          stroke="#fffff"
          data-url={district.url}
        />
        <text class="district-name" x={district.labelPosition.x} y={district.labelPosition.y} fill="#000">
          {district.name}
        </text>
      </g>
    ))}
  </svg>

  <div class="district-tooltip" id="tooltip"></div>
</div>

<!-- Add interactive logic using vanilla JS -->
<script type="module">
  const tooltip = document.getElementById('tooltip');
  document.querySelectorAll('path').forEach((path) => {
    path.addEventListener('mouseenter', (e) => {
      const name = path.nextElementSibling?.textContent;
      tooltip.textContent = name;
      tooltip.style.left = e.clientX + 10 + 'px';
      tooltip.style.top = e.clientY + 10 + 'px';
      tooltip.style.display = 'block';
    });

    path.addEventListener('mousemove', (e) => {
      tooltip.style.left = e.clientX + 10 + 'px';
      tooltip.style.top = e.clientY + 10 + 'px';
    });

    path.addEventListener('mouseleave', () => {
      tooltip.style.display = 'none';
    });

    path.addEventListener('click', () => {
      const url = path.dataset.url;
      if (url) window.open(url, '_blank');
    });
  });
</script>
